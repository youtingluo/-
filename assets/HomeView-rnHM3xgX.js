import{o as a,c as n,a as s,t as g,n as _,r as i,b as W,w as P,d as ye,e as C,f as fe,u as h,g as me,v as be,h as k,F as f,i as m,j as S,k as I,l as he,m as ge,p as xe}from"./index-B5wv8RVL.js";import{_ as X,a as ke,c as _e,b as we,e as Y,m as Ce,L as Te}from"./coverArray-D87eey79.js";import{_ as qe,a as Me,S as Ae}from"./ScrollToTop-BfDLFxip.js";import{_ as L}from"./IndustryComponent-CcidWA4U.js";const Se={__name:"IndustryListComponent",props:{selectedindustry:String,industry:String},setup(T){return(w,u)=>(a(),n("li",null,[s("button",{type:"button",class:_(["btn btn-custom border-0",{active:T.selectedindustry===T.industry}]),onClick:u[0]||(u[0]=j=>w.$emit("change-industry",T.industry))},g(T.industry),3)]))}},$e={class:"container py-3"},Oe={class:"input-group mb-3 search-bar shadow-sm"},Ve={class:"position-relative flex-grow-1"},Ie={class:"border-bottom border-2 mb-4"},Ne={class:"mb-4"},Re={class:"d-flex fs-3 mb-3 flex-wrap"},Ee={key:0,class:"row gx-2 mb-4"},Be={class:"col"},De={class:"d-flex fs-3 flex-wrap"},Le={class:"me-2"},je=["onClick"],ze={key:1,class:"row mb-4"},Fe={class:"col"},Ge={class:"d-flex flex-wrap fs-3"},He={class:"me-2"},Je=["onClick"],Ue={key:0,class:"fs-6 text-black text-opacity-50"},Ze={class:"h5"},Ke={class:"text-danger"},Qe={class:"mb-2"},We={class:"pb-2"},Pe=["onClick"],Xe={key:0,class:"text-center py-5"},Ye={key:1,class:"row g-3"},et={key:2,class:"row g-3"},tt={key:1,class:"text-center py-5"},st={class:"fs-6 text-black text-opacity-50"},lt={class:"row g-3"},at={__name:"HomeView",setup(T){const w=ge(),u=he(),j="AIzaSyD5bMMUbcVKn0XhDjWNzZOZ0_YQwQjd2nU",ee="1z-irp4iTLpHxl64hk6cGQ-94d4x5cTbZwHlV3eRw8fM",p=i("全部"),q=i(!1),b=i([]),z=i([]);async function $(l="全部"){B=!1,q.value=!0,p.value=l;const e=`${l}`,r=`https://sheets.googleapis.com/v4/spreadsheets/${ee}/values/${e}?key=${j}`;try{const t=await ke.get(r);q.value=!1;const o=t.data.values;F.value=o[0].slice(2,-3),N.value=o[0].slice(2,-2),b.value=_e(o),z.value=we(b.value),u.query.search?(y.value=u.query.search,v.value=re(),M.value=Y(b.value,v.value),x.value=K(u.query.search)):(x.value=[],M.value=[],v.value=[]),c.value=u.query.MultipleTypeArray?JSON.parse(u.query.MultipleTypeArray):[],d.value=u.query.selected?JSON.parse(u.query.selected):[],Q()}catch(t){q.value=!1,console.error("Error fetching values:",t)}}const N=i([]),F=i([]),d=i([]),G=W(()=>b.value.filter(l=>{const e=c.value.every(t=>l[t]&&l[t].length>0),r=d.value.every(t=>c.value.some(o=>l[o]&&l[o].includes(t)));return e&&r})),y=i(""),te=i(null),v=i([]),M=i([]),x=i([]),R=i(null),E=i(!1),se=()=>{E.value=!0},le=()=>{E.value=!1},ae=["火鍋","飲料","剉冰","燒烤","烘焙","早餐","牛排"],H=l=>{w.push({query:{}}),p.value=l,y.value=""},ne=async l=>{y.value=l,w.replace({path:"/",query:{search:l}}),await $("全部"),await xe(()=>{if(R.value){const r=document.body.getBoundingClientRect().top,o=R.value.getBoundingClientRect().top-r-110;window.scrollTo({top:o,behavior:"smooth"})}})},oe=()=>{E.value||ne(y.value)},J=Me.debounce(oe,600),U=()=>{window.scrollTo(0,0),y.value="",v.value=[],M.value=[],x.value=[],w.replace({query:{}})};P(v,()=>{M.value=Y(b.value,v.value),x.value=K(u.query.search)},{deep:!0});let Z=i([]);const re=()=>{const l=[],e=y.value;b.value.forEach(t=>{const o=new RegExp(e,"i");F.value.forEach(V=>{if(o.test(t[V])){const ve=t[V].split(",").filter(pe=>o.test(pe));l.push(...ve)}})});const r=Array.from(new Set(l));return Z.value=[...r],r};let B=!0;const ue=l=>{B||(v.value=[],B=!0);const e=v.value.indexOf(l);e>-1?v.value.splice(e,1):v.value.push(l)},K=l=>{if(!l){x.value=[];return}const e=b.value.filter(r=>N.value.some(o=>v.value.some(V=>r[o]&&r[o].includes(V))));return Ce(e)},c=i([]),ie=l=>{const e=c.value.indexOf(l);e>-1?c.value.splice(e,1):c.value.push(l),Q();let r=d.value.filter(t=>A.value.indexOf(t)>-1);d.value=r},A=i([]),O=i(!1),ce=l=>{const e=d.value.indexOf(l);e>-1?d.value.splice(e,1):d.value.push(l)},Q=()=>{const l=[];b.value.forEach(e=>{c.value.forEach(r=>{e[r]&&l.push(e[r])})}),A.value=[...new Set(l.filter(Boolean).join().split(","))]},de=W(()=>O.value?A.value:A.value.slice(0,8));function D(l){w.push({path:`company/${l}`,query:{search:y.value,selectedindustry:p.value,MultipleTypeArray:JSON.stringify(c.value),selected:JSON.stringify(d.value)}})}return ye(()=>{if(u.query.selectedindustry!=="全部"&&u.query.selectedindustry){$(u.query.selectedindustry);return}$(p.value)}),P(()=>p.value,()=>{$(p.value)}),(l,e)=>{var r;return a(),n(f,null,[C(h(Te),{active:q.value,"onUpdate:active":e[0]||(e[0]=t=>q.value=t)},{default:fe(()=>e[7]||(e[7]=[s("div",{class:"loader"},null,-1)])),_:1},8,["active"]),C(Ae),s("div",$e,[s("div",Oe,[s("div",Ve,[e[8]||(e[8]=s("div",{class:"position-absolute start-10 bottom-0"},[s("span",{class:"material-symbols-outlined d-inline-block align-baseline"}," search ")],-1)),me(s("input",{ref_key:"input",ref:te,type:"text",class:"form-control border-0 ps-5",placeholder:"搜尋食材/廠商","onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),onInput:e[2]||(e[2]=(...t)=>h(J)&&h(J)(...t)),onCompositionstart:se,onCompositionend:le},null,544),[[be,y.value]])]),s("div",null,[y.value?(a(),n("button",{key:0,onClick:U,class:"btn btn-dark btn-sm rounded-0",type:"button"},e[9]||(e[9]=[s("span",{class:"material-symbols-outlined"}," close ",-1)]))):k("",!0)])]),s("div",Ie,[s("div",Ne,[e[10]||(e[10]=s("h3",{class:"fs-6 text-black text-opacity-50"},"廠商行業",-1)),s("ul",Re,[s("li",null,[s("button",{type:"button",class:_(["btn btn-custom border-0 me-1",{active:p.value==="全部"}]),onClick:e[3]||(e[3]=t=>H("全部"))}," 全部 ",2)]),(a(),n(f,null,m(ae,t=>C(Se,{class:"me-1",key:t,selectedindustry:p.value,onChangeIndustry:H,industry:t},null,8,["selectedindustry","industry"])),64))])]),p.value!=="全部"?(a(),n("div",Ee,[s("div",Be,[e[11]||(e[11]=s("h3",{class:"fs-6 text-black text-opacity-50"},"原物料種類",-1)),s("ul",De,[s("li",Le,[s("a",{href:"#",class:_(["btn btn-custom border-0",{active:!c.value.length}]),onClick:e[4]||(e[4]=()=>{c.value=[],d.value=[]})},"全部",2)]),(a(!0),n(f,null,m(N.value,t=>(a(),n("li",{class:"me-2",key:t},[s("a",{href:"#",class:_(["btn btn-custom border-0",{active:c.value.includes(t)}]),onClick:S(o=>ie(t),["prevent"])},g(t),11,je)]))),128))])])])):k("",!0),c.value.length||d.value.length?(a(),n("div",ze,[s("div",Fe,[e[12]||(e[12]=s("h3",{class:"fs-6 text-black text-opacity-50"},"類別細項",-1)),s("ul",Ge,[s("li",He,[s("a",{href:"#",class:_(["btn btn-custom border-0",{active:!d.value.length}]),onClick:e[5]||(e[5]=t=>d.value=[])},"全部",2)]),(a(!0),n(f,null,m(de.value,t=>(a(),n("li",{class:"me-2",key:t},[s("a",{href:"#",class:_(["btn btn-custom border-0",{active:d.value.includes(t)}]),onClick:S(o=>ce(t),["prevent"])},g(t),11,Je)]))),128)),s("li",null,[A.value.length>8?(a(),n("a",{key:0,href:"#",class:"btn text-primary border-0",onClick:e[6]||(e[6]=S(t=>O.value=!O.value,["prevent"]))},g(O.value?"收起－":"更多+"),1)):k("",!0)])])])])):k("",!0)]),p.value!=="全部"?(a(),n("h3",Ue,"廠商")):k("",!0),h(u).query.search?(a(),n("div",{key:1,ref_key:"scrollbox",ref:R},[s("p",Ze,[e[14]||(e[14]=I(" 以下為 ")),s("span",Ke,g(h(u).query.search),1),e[15]||(e[15]=I(" 的搜尋結果 ")),s("button",{type:"button",class:"btn btn-sm btn-danger me-2",onClick:S(U,["prevent"])},e[13]||(e[13]=[s("span",{class:"material-symbols-outlined d-inline-block align-middle"}," close ",-1)]))]),s("div",Qe,[e[16]||(e[16]=I(" 已選取：")),(a(!0),n(f,null,m(v.value,t=>(a(),n("span",{key:t,class:"badge rounded-pill text-bg-secondary fw-normal fs-6 bg-warning me-2 mb-1"},g(t),1))),128))]),s("div",We,[e[17]||(e[17]=I(" 全部：")),(a(!0),n(f,null,m(h(Z),t=>(a(),n("span",{class:_(["btn bedge-custom rounded-pill me-1 mb-1",{active:v.value.includes(t)}]),key:t,onClick:S(o=>ue(t),["prevent"])},g(t),11,Pe))),128))]),(r=x.value)!=null&&r.length?(a(),n("div",Ye,[(a(!0),n(f,null,m(x.value,t=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:t.編號},[C(L,{onGoCompany:D,company:t,"mutiple-type-array":M.value,tag:["編號","廠商","網址","類別","公司簡介","評測"]},null,8,["company","mutiple-type-array"])]))),128))])):(a(),n("div",Xe,e[18]||(e[18]=[s("img",{src:X,alt:"無資料"},null,-1)])))],512)):p.value!=="全部"&&!h(u).query.search?(a(),n("div",et,[G.value.length?(a(!0),n(f,{key:0},m(G.value,t=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:t.編號},[C(L,{onGoCompany:D,company:t,"mutiple-type-array":c.value,tag:["編號","廠商","網址","評測"]},null,8,["company","mutiple-type-array"])]))),128)):(a(),n("div",tt,e[19]||(e[19]=[s("img",{src:X,alt:"無資料"},null,-1)])))])):k("",!0),p.value==="全部"&&!h(u).query.search?(a(!0),n(f,{key:3},m(z.value,t=>(a(),n("div",{class:"mb-4",key:t.編號},[s("h3",st,g(Object.keys(t).toString()),1),s("div",lt,[(a(!0),n(f,null,m(t[Object.keys(t)],o=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:o.編號},[C(L,{onGoCompany:D,company:o,"mutiple-type-array":c.value,tag:["編號","廠商","網址","類別","公司簡介","評測"]},null,8,["company","mutiple-type-array"])]))),128))])]))),128)):k("",!0)])],64)}}},it=qe(at,[["__scopeId","data-v-771eff81"]]);export{it as default};
