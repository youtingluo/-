import{r as c,c as K,o as oe,w as re,a as o,b as ae,d as ue,u as x,e as t,f as ie,v as ce,n as h,F as f,g as _,h as w,i as d,t as k,j as U,k as de,l as r,m as ve}from"./index-BILeH2Fv.js";import{_ as Q,a as be,L as fe}from"./index-CUH-131T.js";const pe=(E,g)=>{const i=E.__vccOpts||E;for(const[S,V]of g)i[S]=V;return i},ye={class:"container py-3"},he={class:"input-group mb-3 search-bar shadow-sm"},ke={class:"border-bottom border-2 mb-4"},ge={class:"mb-4"},me={class:"d-flex fs-3 mb-3 flex-wrap"},xe={key:0,class:"row gx-2 mb-4"},_e={class:"col"},we={class:"d-flex fs-3 flex-wrap"},Ce={class:"me-2"},qe=["onClick"],$e={key:1,class:"row mb-4"},Oe={class:"col"},Te={class:"d-flex flex-wrap fs-3"},je={class:"me-2"},Ae=["onClick"],Me={key:0,class:"fs-6 text-black text-opacity-50"},Ee={class:"h5"},Se={class:"text-danger"},Ve={class:"pb-2"},Re=["onClick"],Ne={key:0,class:"text-center py-5"},De={key:1,class:"row gx-2"},Be=["onClick"],Le={class:"p-3 rounded-5 h-100 shadow-sm bg-white"},ze={class:"d-flex justify-content-between mb-3"},Fe=["href"],He={class:"d-flex flex-wrap"},Ie={key:0},Je={key:2,class:"row gx-2"},Ke=["onClick"],Ue={class:"p-3 rounded-5 h-100 shadow-sm bg-white"},Qe={class:"d-flex justify-content-between mb-3"},Ze=["href"],We={class:"d-flex flex-wrap"},Ge={key:0},Pe={key:1,class:"text-center py-5"},Xe={class:"fs-6 text-black text-opacity-50"},Ye={class:"row gx-2"},et=["onClick"],tt={class:"p-3 rounded-5 h-100 shadow-sm bg-white"},st={class:"d-flex justify-content-between mb-3"},lt=["href"],nt={class:"d-flex flex-wrap"},ot={key:0},rt={class:"badge rounded-pill text-bg-secondary fw-normal fs-6 me-2 mb-2"},at={__name:"HomeView",setup(E){const g=ve(),i=de(),S="AIzaSyD5bMMUbcVKn0XhDjWNzZOZ0_YQwQjd2nU",V="1z-irp4iTLpHxl64hk6cGQ-94d4x5cTbZwHlV3eRw8fM",u=c(""),$=c(!1);async function j(n="全部"){$.value=!0,u.value=n;const e=`${n}!A1:AA70`,l=`https://sheets.googleapis.com/v4/spreadsheets/${V}/values/${e}?key=${S}`;try{const s=await be.get(l);$.value=!1;const a=s.data.values;R.value=a[0].slice(2,-2),z.value=a[0].slice(2,-1),C.value=Z(a),W(C.value),i.query.search?(p.value=i.query.search,O.value=X(),T.value=Y(C.value,O.value),q.value=ee(i.query.search)):(q.value=[],T.value=[],O.value=[]),b.value=i.query.MultipleTypeArray?JSON.parse(i.query.MultipleTypeArray):[],J()}catch(s){$.value=!1,console.error("Error fetching values:",s)}}function Z(n){const e=n[0],l=[];for(let s=1;s<n.length;s++){const a={};for(let y=0;y<e.length;y++)a[e[y]]=n[s][y];l.push(a)}return l}const L=c([]);function W(n){const e=n.reduce((s,a)=>{const y=Object.fromEntries(Object.entries(a).filter(([,B])=>B!==void 0||""));return s[a.類別]||(s[a.類別]=[]),s[a.類別].push(y),s},{}),l=[];for(const s in e)l.push({[s]:e[s]});L.value=l}const C=c([]),z=c([]),R=c([]),m=c([]),v=c(!1),F=K(()=>m.value.length?C.value.filter(n=>{const e=b.value.every(s=>n[s]&&n[s].length>0),l=b.value.some(s=>m.value.every(a=>n[s]&&n[s].includes(a)));return e&&l}):C.value.filter(n=>b.value.every(e=>n[e]))),N=c(null),G=()=>{if(I(p.value),N.value){const e=document.body.getBoundingClientRect().top,s=N.value.getBoundingClientRect().top-e-110;window.scrollTo({top:s,behavior:"smooth"})}},H=()=>{window.scrollTo(0,0),p.value="",O.value=[],T.value=[],q.value=[],g.replace({query:{}})},p=c(""),P=c(null),O=c([]),T=c([]),q=c([]),I=n=>{p.value=n,g.replace({path:"/",query:{search:n}}),j("全部")},X=()=>{const n=[],e=p.value;return C.value.forEach(s=>{const a=new RegExp(e,"i");R.value.forEach(y=>{if(a.test(s[y])){const B=s[y].split(",").filter(ne=>a.test(ne));n.push(...B)}})}),Array.from(new Set(n))},Y=(n,e)=>{const l=[];return n.forEach(s=>{Object.keys(s).forEach(a=>{e.forEach(y=>{s[a]&&s[a].includes(y)&&l.push(a)})})}),[...new Set(l)]},ee=n=>{if(!n){q.value=[];return}return C.value.filter(e=>{const l=new RegExp(n,"i");return R.value.some(a=>l.test(e[a]))})},b=c([]),te=n=>{const e=b.value.indexOf(n);e>-1?b.value.splice(e,1):b.value.push(n),J()},se=n=>{const e=m.value.indexOf(n);e>-1?m.value.splice(e,1):m.value.push(n)},A=c([]),M=c(!1),J=()=>{const n=[];C.value.forEach(e=>{b.value.forEach(l=>{n.push(e[l])})}),m.value=i.query.selected?JSON.parse(i.query.selected):[],A.value=[...new Set(n.filter(Boolean).join().split(","))]},le=K(()=>M.value?A.value:A.value.slice(0,8));function D(n){g.push({path:`company/${n}`,query:{selectedindustry:u.value,MultipleTypeArray:JSON.stringify(b.value),selected:JSON.stringify(m.value)}})}return oe(()=>{if(j(),i.query.selectedindustry!=="全部"&&i.query.selectedindustry){j(i.query.selectedindustry);return}}),re(()=>u.value,()=>{j(u.value)},{deep:!0}),(n,e)=>(r(),o(f,null,[ae(x(fe),{active:$.value,"onUpdate:active":e[0]||(e[0]=l=>$.value=l)},{default:ue(()=>e[20]||(e[20]=[t("div",{class:"loader"},null,-1)])),_:1},8,["active"]),t("div",ye,[t("div",he,[t("button",{class:"btn btn-light btn-sm rounded-0",type:"button",onClick:H},e[21]||(e[21]=[t("span",{class:"material-symbols-outlined d-inline-block align-middle"}," chevron_backward ",-1)])),ie(t("input",{ref_key:"input",ref:P,type:"text",class:"form-control border-0",placeholder:"搜尋食材/廠商","onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),onKeyup:G},null,544),[[ce,p.value]]),e[22]||(e[22]=t("button",{class:"btn btn-dark btn-sm rounded-0",type:"button"},[t("span",{class:"material-symbols-outlined"}," search ")],-1))]),t("div",ke,[t("div",ge,[e[23]||(e[23]=t("h3",{class:"fs-6 text-black text-opacity-50"},"廠商行業",-1)),t("ul",me,[t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="全部"}]),onClick:e[2]||(e[2]=()=>{x(g).push({query:{}}),u.value="全部"})}," 全部 ",2)]),t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="火鍋"}]),onClick:e[3]||(e[3]=()=>{x(g).push({query:{}}),u.value="火鍋",p.value=""})}," 火鍋 ",2)]),t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="飲料"}]),onClick:e[4]||(e[4]=()=>{x(g).push({query:{}}),u.value="飲料",p.value=""})}," 飲料 ",2)]),t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="剉冰"}]),onClick:e[5]||(e[5]=()=>{x(g).push({query:{}}),u.value="剉冰",p.value=""})}," 剉冰 ",2)]),t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="燒烤"}]),onClick:e[6]||(e[6]=()=>{x(g).push({query:{}}),u.value="燒烤",p.value=""})}," 燒烤 ",2)]),t("li",null,[t("button",{type:"button",class:h(["btn btn-custom border-0",{active:u.value==="烘焙"}]),onClick:e[7]||(e[7]=()=>{x(g).push({query:{}}),u.value="烘焙",p.value=""})}," 烘焙 ",2)])])]),u.value!=="全部"?(r(),o("div",xe,[t("div",_e,[e[24]||(e[24]=t("h3",{class:"fs-6 text-black text-opacity-50"},"原物料種類",-1)),t("ul",we,[t("li",Ce,[t("a",{href:"#",class:h(["btn btn-custom border-0",{active:!b.value.length}]),onClick:e[8]||(e[8]=()=>{b.value=[],m.value=[]})},"全部",2)]),(r(!0),o(f,null,_(z.value,l=>(r(),o("li",{class:"me-2",key:l},[t("a",{href:"#",class:h(["btn btn-custom border-0",{active:b.value.includes(l)}]),onClick:d(s=>te(l),["prevent"])},k(l),11,qe)]))),128))])])])):w("",!0),b.value.length?(r(),o("div",$e,[t("div",Oe,[e[25]||(e[25]=t("h3",{class:"fs-6 text-black text-opacity-50"},"類別細項",-1)),t("ul",Te,[t("li",je,[t("a",{href:"#",class:h(["btn btn-custom border-0",{active:!m.value.length}]),onClick:e[9]||(e[9]=l=>m.value=[])},"全部",2)]),(r(!0),o(f,null,_(le.value,l=>(r(),o("li",{key:l},[t("a",{href:"#",class:h(["btn btn-custom border-0",{active:m.value.includes(l)}]),onClick:d(s=>se(l),["prevent"])},k(l),11,Ae)]))),128)),t("li",null,[A.value.length>8?(r(),o("a",{key:0,href:"#",class:"btn text-primary border-0",onClick:e[10]||(e[10]=d(l=>M.value=!M.value,["prevent"]))},k(M.value?"收起－":"更多"),1)):w("",!0)])])])])):w("",!0)]),u.value!=="全部"?(r(),o("h3",Me,"廠商")):w("",!0),x(i).query.search?(r(),o("div",{key:1,ref_key:"scrollbox",ref:N},[t("p",Ee,[e[27]||(e[27]=U(" 以下為 ")),t("span",Se,k(x(i).query.search),1),e[28]||(e[28]=U(" 的搜尋結果 ")),t("button",{type:"button",class:"btn btn-sm btn-danger fs-6",onClick:d(H,["prevent"])},e[26]||(e[26]=[t("span",{class:"material-symbols-outlined d-inline-block align-middle"}," close ",-1)]))]),t("div",Ve,[(r(!0),o(f,null,_(O.value,l=>(r(),o("span",{class:"badge rounded-pill text-bg-primary me-1 mb-1 btn",key:l,onClick:s=>I(l)},k(l),9,Re))),128))]),q.value.length?(r(),o("div",De,[(r(!0),o(f,null,_(q.value,l=>(r(),o("div",{class:"col-6 col-lg-3 mb-3",key:l.編號},[t("a",{href:"#",onClick:d(s=>D(l.編號),["prevent"])},[t("div",Le,[t("div",ze,[t("div",null,[t("a",{href:l.網址,target:"_blank",class:"fs-6",onClick:e[11]||(e[11]=d(()=>{},["stop"]))},k(l.廠商),9,Fe)]),t("div",null,[v.value?(r(),o("i",{key:0,class:"bi bi-heart-fill fs-4 link-info",onClick:e[12]||(e[12]=d(s=>v.value=!v.value,["prevent"]))})):(r(),o("i",{key:1,class:"bi bi-heart fs-4 link-gray",onClick:e[13]||(e[13]=d(s=>v.value=!v.value,["prevent"]))}))])]),t("div",He,[(r(!0),o(f,null,_(Object.keys(l),s=>(r(),o(f,{key:s},[l[s]&&s!=="編號"&&s!=="廠商"&&s!=="網址"&&s!=="類別"&&s!=="公司簡介"?(r(),o("div",Ie,[t("span",{class:h(["badge rounded-pill text-bg-secondary fw-normal fs-6 me-2 mb-2",[{"bg-warning":T.value.includes(s)},{"text-dark":T.value.includes(s)}]])},k(s),3)])):w("",!0)],64))),128))])])],8,Be)]))),128))])):(r(),o("div",Ne,e[29]||(e[29]=[t("img",{src:Q,alt:"無資料"},null,-1)])))],512)):u.value!=="全部"&&!x(i).query.search?(r(),o("div",Je,[F.value.length?(r(!0),o(f,{key:0},_(F.value,l=>(r(),o("div",{class:"col-6 col-lg-3 mb-3",key:l.編號},[t("a",{href:"#",onClick:d(s=>D(l.編號),["prevent"])},[t("div",Ue,[t("div",Qe,[t("div",null,[t("a",{href:l.網址,target:"_blank",class:"fs-6",onClick:e[14]||(e[14]=d(()=>{},["stop"]))},k(l.廠商),9,Ze)]),t("div",null,[v.value?(r(),o("i",{key:0,class:"bi bi-heart-fill fs-4 link-info",onClick:e[15]||(e[15]=d(s=>v.value=!v.value,["prevent"]))})):(r(),o("i",{key:1,class:"bi bi-heart fs-4 link-gray",onClick:e[16]||(e[16]=d(s=>v.value=!v.value,["prevent"]))}))])]),t("div",We,[(r(!0),o(f,null,_(Object.keys(l),s=>(r(),o(f,{key:s},[l[s]&&s!=="編號"&&s!=="廠商"&&s!=="網址"?(r(),o("div",Ge,[t("span",{class:h(["badge rounded-pill text-bg-secondary fw-normal fs-6 me-2 mb-2",[{"bg-warning":b.value.includes(s)},{"text-dark":b.value.includes(s)}]])},k(s),3)])):w("",!0)],64))),128))])])],8,Ke)]))),128)):(r(),o("div",Pe,e[30]||(e[30]=[t("img",{src:Q,alt:"無資料"},null,-1)])))])):w("",!0),u.value==="全部"&&!x(i).query.search?(r(!0),o(f,{key:3},_(L.value,l=>(r(),o("div",{class:"mb-4",key:l.編號},[t("h3",Xe,k(Object.keys(l).toString()),1),t("div",Ye,[(r(!0),o(f,null,_(l[Object.keys(l)],s=>(r(),o("div",{class:"col-6 col-lg-3 mb-3",key:s.編號},[t("a",{href:"#",onClick:d(a=>D(s.編號),["prevent"])},[t("div",tt,[t("div",st,[t("div",null,[t("a",{href:s.網址,target:"_blank",class:"fs-6",onClick:e[17]||(e[17]=d(()=>{},["stop"]))},k(s.廠商),9,lt)]),t("div",null,[v.value?(r(),o("i",{key:0,class:"bi bi-heart-fill fs-4 link-info",onClick:e[18]||(e[18]=d(a=>v.value=!v.value,["prevent"]))})):(r(),o("i",{key:1,class:"bi bi-heart fs-4 link-gray",onClick:e[19]||(e[19]=d(a=>v.value=!v.value,["prevent"]))}))])]),t("div",nt,[(r(!0),o(f,null,_(Object.keys(s),a=>(r(),o(f,{key:a},[s[a]&&!["編號","廠商","網址","類別","公司簡介"].includes(a)?(r(),o("div",ot,[t("span",rt,k(a),1)])):w("",!0)],64))),128))])])],8,et)]))),128))])]))),128)):w("",!0)])],64))}},ct=pe(at,[["__scopeId","data-v-caf9ac71"]]);export{ct as default};
