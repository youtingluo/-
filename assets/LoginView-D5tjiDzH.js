import{x as N,y as U,e as i,a as o,b as s,j as x,k as _,w as u,l as g,v as y,d as m,m as r,t as h,u as C,z as G,o as n,A as V,q as M,B as P,C as $}from"./index-uAHsGkss.js";const A={class:"container pt-5"},D={class:"row justify-content-center"},q={class:"col-lg-6"},z={class:"nav nav-tabs",ref:"loginTab",role:"tablist"},W={class:"nav-item",role:"presentation"},F={class:"tab-content bg-white p-3 rounded",id:"myTabContent"},H={class:"tab-pane show active"},I={key:0},J={class:"mb-3"},K={class:"d-flex justify-content-between align-items-center"},O=["disabled"],Q={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},X={key:0,class:"text-danger mt-2 mb-0"},Y={key:1},Z={class:"mb-3"},ee={class:"mb-3"},se={class:"d-flex justify-content-between align-items-center"},te=["disabled"],le={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},ae={key:0,class:"text-danger my-1"},oe=["disabled"],ne={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},de={__name:"LoginView",setup(ie){const f=N(),{piniaLoading:w}=U(f),L=V("$toast"),R=V("$swal"),j=M(),v=i(""),p=i(""),c=i(""),t=i(!1),S=i(""),l=i(""),T=async()=>{t.value=!0;try{await f.login(v.value,p.value)&&(L.fire({icon:"success",title:"登入成功"}),j.push("/"))}catch(a){a.code==="auth/invalid-credential"?l.value="帳號或密碼不正確":a.code==="auth/invalid-email"&&(l.value="信箱格式不正確"),t.value=!1}finally{t.value=!1}},b=i(!1),B=()=>{t.value=!0,P($,c.value).then(()=>{t.value=!1,R.fire({title:"信件已發送",html:`<div class="text-success mt-2 mb-0">
              <p>
                密碼重設信件已發送，請檢查您的信箱。
              </p>
              <p>
                <small class="text-danger">
                  <span class="material-symbols-outlined d-inline-block align-middle">
                info
                </span>
                  請注意，假如未使用此信箱註冊過，並不會收到重設信件！
                </small>
              </p>
              </div>`}),b.value=!1}).catch(a=>{t.value=!1,l.value=a.message,S.value=""})},E=async()=>{l.value="";try{await f.loginWithGoogle()}catch(a){l.value=a.message}};return(a,e)=>{const k=G("RouterLink");return n(),o("div",A,[s("div",D,[s("div",q,[e[18]||(e[18]=s("h1",{class:"mb-3 text-center"},"登入",-1)),s("ul",z,[e[6]||(e[6]=s("li",{class:"nav-item me-auto",role:"presentation"},[s("div",{class:"nav-link active"},"登入")],-1)),s("li",W,[x(k,{class:"nav-link text-dark fs-6",to:"/"},{default:_(()=>e[5]||(e[5]=[s("span",{class:"material-symbols-outlined d-inline-block align-bottom"}," home ",-1),r("回首頁")])),_:1})])],512),s("div",F,[s("div",H,[b.value?(n(),o("div",I,[s("form",{onSubmit:u(B,["prevent"])},[s("div",J,[e[7]||(e[7]=s("label",{for:"reset-password",class:"form-label"},"信箱",-1)),g(s("input",{type:"email",class:"form-control",id:"reset-password",placeholder:"請輸入註冊時信箱","onUpdate:modelValue":e[0]||(e[0]=d=>c.value=d)},null,512),[[y,c.value]])]),s("div",K,[s("button",{type:"submit",class:"btn btn-primary flex-grow-1 me-2",disabled:t.value||!c.value},[t.value?(n(),o("span",Q)):m("",!0),e[8]||(e[8]=r("寄送信件 "))],8,O),s("a",{href:"#",class:"link-primary",onClick:e[1]||(e[1]=u(d=>b.value=!1,["prevent"]))},"返回登入")])],32),l.value?(n(),o("p",X,h(l.value),1)):m("",!0)])):(n(),o("div",Y,[s("form",{onSubmit:u(T,["prevent"])},[s("div",Z,[e[9]||(e[9]=s("label",{for:"login-email",class:"form-label"},"信箱",-1)),g(s("input",{type:"email",class:"form-control",id:"login-email",placeholder:"請輸入信箱","onUpdate:modelValue":e[2]||(e[2]=d=>v.value=d)},null,512),[[y,v.value]])]),s("div",ee,[e[10]||(e[10]=s("label",{for:"password",class:"form-label"},"密碼",-1)),g(s("input",{type:"password",class:"form-control",id:"password",placeholder:"請輸入密碼","onUpdate:modelValue":e[3]||(e[3]=d=>p.value=d)},null,512),[[y,p.value]])]),s("div",se,[s("button",{type:"submit",class:"btn btn-primary flex-grow-1 text-white me-1",disabled:t.value||!v.value||!p.value},[t.value?(n(),o("span",le)):m("",!0),e[11]||(e[11]=r("登入 "))],8,te),s("div",null,[x(k,{to:"signup",class:"btn btn-outline-dark"},{default:_(()=>e[12]||(e[12]=[r("前往註冊")])),_:1})])])],32),l.value?(n(),o("p",ae,[e[13]||(e[13]=s("span",{class:"material-symbols-outlined d-inline-block align-middle"}," cancel ",-1)),r(" "+h(l.value),1)])):m("",!0),e[17]||(e[17]=s("hr",null,null,-1)),s("button",{onClick:u(E,["prevent"]),class:"btn btn-outline-danger mb-2 w-100",disabled:C(w)},[C(w)?(n(),o("span",ne)):m("",!0),e[14]||(e[14]=s("i",{class:"bi bi-google me-2"},null,-1)),e[15]||(e[15]=r("用 Google 帳號登入 "))],8,oe),s("a",{href:"#",class:"link-primary text-end",onClick:e[4]||(e[4]=u(()=>{b.value=!0,l.value=""},["prevent"]))},e[16]||(e[16]=[s("span",{class:"material-symbols-outlined d-inline-block align-middle fs-6"}," help ",-1),r("忘記密碼")]))]))])])])])])}}};export{de as default};
