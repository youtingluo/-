import{o as a,c as n,a as s,t as x,n as w,r as c,b as P,w as X,d as pe,e as C,f as me,u as y,g as fe,v as he,h as _,F as f,i as b,j as q,k as O,l as be,m as ge,p as xe}from"./index-C2228Whi.js";import{_ as Y,a as ke,c as _e,b as qe,e as J,m as we,L as Ce}from"./coverArray-D28FKHkL.js";import{_ as Te,a as Me}from"./ScrollToTop-BC8yOdy5.js";import{_ as L}from"./IndustryComponent-DB8wMob0.js";const Ae={__name:"IndustryListComponent",props:{selectedindustry:String,industry:String},setup(T){return(p,o)=>(a(),n("li",null,[s("button",{type:"button",class:w(["btn btn-custom border-0",{active:T.selectedindustry===T.industry}]),onClick:o[0]||(o[0]=N=>p.$emit("change-industry",T.industry))},x(T.industry),3)]))}},$e={class:"container py-3"},Ve={class:"input-group mb-3 search-bar shadow-sm"},je={class:"position-relative flex-grow-1"},Se={class:"border-bottom border-2 mb-4"},Oe={class:"mb-4"},Re={class:"d-flex fs-3 mb-3 flex-wrap"},Ie={key:0,class:"row gx-2 mb-4"},Ee={class:"col"},Be={class:"d-flex fs-3 flex-wrap"},De={class:"me-2"},Le=["onClick"],Ne={key:1,class:"row mb-4"},ze={class:"col"},Fe={class:"d-flex flex-wrap fs-3"},Ge={class:"me-2"},Ue=["onClick"],Ze={key:0,class:"fs-6 text-black text-opacity-50"},He={class:"h5"},Ke={class:"text-danger"},Qe={class:"mb-2"},We={class:"pb-2"},Pe=["onClick"],Xe={key:0,class:"text-center py-5"},Ye={key:1,class:"row g-3"},Je={key:2,class:"row g-3"},et={key:1,class:"text-center py-5"},tt={class:"fs-6 text-black text-opacity-50"},st={class:"row g-3"},ut={__name:"HomeView",setup(T){const p=ge(),o=be(),N="AIzaSyD5bMMUbcVKn0XhDjWNzZOZ0_YQwQjd2nU",ee="1z-irp4iTLpHxl64hk6cGQ-94d4x5cTbZwHlV3eRw8fM",m=c("全部"),M=c(!1),g=c([]),z=c([]);async function V(l="全部"){B=!1,M.value=!0,m.value=l;const e=`${l}`,u=`https://sheets.googleapis.com/v4/spreadsheets/${ee}/values/${e}?key=${N}`;try{const t=await ke.get(u);M.value=!1;const r=t.data.values;F.value=r[0].slice(2,-3),R.value=r[0].slice(2,-2),g.value=_e(r),z.value=qe(g.value),o.query.search?(h.value=o.query.search,v.value=ue(),A.value=J(g.value,v.value),k.value=Q(o.query.search)):(k.value=[],A.value=[],v.value=[]),i.value=o.query.MultipleTypeArray?o.query.MultipleTypeArray.split(","):[],d.value=o.query.selected?o.query.selected.split(","):[],W()}catch(t){M.value=!1,console.error("Error fetching values:",t)}}const R=c([]),F=c([]),d=c([]),G=P(()=>g.value.filter(l=>{const e=i.value.every(t=>l[t]&&l[t].length>0),u=d.value.every(t=>i.value.some(r=>l[r]&&l[r].includes(t)));return e&&u})),h=c(""),te=c(null),v=c([]),A=c([]),k=c([]),I=c(null),E=c(!1),se=()=>{E.value=!0},le=()=>{E.value=!1},ae=["火鍋","飲料","剉冰","燒烤","烘焙","早餐","牛排"],U=l=>{p.push({query:{selectedindustry:l}}),m.value=l,h.value="",i.value=[],d.value=[]},ne=async l=>{h.value=l,p.replace({path:"/",query:{search:l}}),await V("全部"),await xe(()=>{if(I.value){const u=document.body.getBoundingClientRect().top,r=I.value.getBoundingClientRect().top-u-110;window.scrollTo({top:r,behavior:"smooth"})}})},oe=()=>{E.value||ne(h.value)},Z=Te.debounce(oe,600),H=()=>{window.scrollTo(0,0),h.value="",v.value=[],A.value=[],k.value=[],p.replace({query:{}})};X(v,()=>{A.value=J(g.value,v.value),k.value=Q(o.query.search)},{deep:!0});let K=c([]);const ue=()=>{const l=[],e=h.value;g.value.forEach(t=>{const r=new RegExp(e,"i");F.value.forEach(S=>{if(r.test(t[S])){const ve=t[S].split(",").filter(ye=>r.test(ye));l.push(...ve)}})});const u=Array.from(new Set(l));return K.value=[...u],u};let B=!0;const re=l=>{B||(v.value=[],B=!0);const e=v.value.indexOf(l);e>-1?v.value.splice(e,1):v.value.push(l)},Q=l=>{if(!l){k.value=[];return}const e=g.value.filter(u=>R.value.some(r=>v.value.some(S=>u[r]&&u[r].includes(S))));return we(e)},i=c([]),ie=l=>{const e=i.value.indexOf(l);e>-1?i.value.splice(e,1):i.value.push(l),p.push({query:{selectedindustry:o.query.selectedindustry,MultipleTypeArray:i.value.join()}}),W();let u=d.value.filter(t=>$.value.indexOf(t)>-1);d.value=u,u.length&&p.push({query:{selectedindustry:o.query.selectedindustry,MultipleTypeArray:i.value.join(),selected:d.value.join()}})},$=c([]),j=c(!1),ce=l=>{const e=d.value.indexOf(l);e>-1?d.value.splice(e,1):d.value.push(l),p.push({query:{selectedindustry:o.query.selectedindustry,MultipleTypeArray:i.value.join(),selected:d.value.join()}})},W=()=>{const l=[];g.value.forEach(e=>{i.value.forEach(u=>{e[u]&&l.push(e[u])})}),$.value=[...new Set(l.filter(Boolean).join().split(","))]},de=P(()=>j.value?$.value:$.value.slice(0,8));function D(l){p.push({path:`company/${l}`,query:o.query})}return pe(()=>{if(o.query.selectedindustry!=="全部"&&o.query.selectedindustry){V(o.query.selectedindustry);return}V(m.value)}),X(()=>m.value,()=>{V(m.value)}),(l,e)=>{var u;return a(),n(f,null,[C(y(Ce),{active:M.value,"onUpdate:active":e[0]||(e[0]=t=>M.value=t)},{default:me(()=>e[7]||(e[7]=[s("div",{class:"loader"},null,-1)])),_:1},8,["active"]),C(Me),s("div",$e,[s("div",Ve,[s("div",je,[e[8]||(e[8]=s("div",{class:"position-absolute start-10 bottom-0"},[s("span",{class:"material-symbols-outlined d-inline-block align-baseline"}," search ")],-1)),fe(s("input",{ref_key:"input",ref:te,type:"text",class:"form-control border-0 ps-5",placeholder:"搜尋食材/廠商","onUpdate:modelValue":e[1]||(e[1]=t=>h.value=t),onInput:e[2]||(e[2]=(...t)=>y(Z)&&y(Z)(...t)),onCompositionstart:se,onCompositionend:le},null,544),[[he,h.value]])]),s("div",null,[h.value?(a(),n("button",{key:0,onClick:H,class:"btn btn-dark btn-sm rounded-0",type:"button"},e[9]||(e[9]=[s("span",{class:"material-symbols-outlined"}," close ",-1)]))):_("",!0)])]),s("div",Se,[s("div",Oe,[e[10]||(e[10]=s("h3",{class:"fs-6 text-black text-opacity-50"},"廠商行業",-1)),s("ul",Re,[s("li",null,[s("button",{type:"button",class:w(["btn btn-custom border-0 me-1",{active:m.value==="全部"}]),onClick:e[3]||(e[3]=t=>U("全部"))}," 全部 ",2)]),(a(),n(f,null,b(ae,t=>C(Ae,{class:"me-1",key:t,selectedindustry:m.value,onChangeIndustry:U,industry:t},null,8,["selectedindustry","industry"])),64))])]),m.value!=="全部"?(a(),n("div",Ie,[s("div",Ee,[e[11]||(e[11]=s("h3",{class:"fs-6 text-black text-opacity-50"},"原物料種類",-1)),s("ul",Be,[s("li",De,[s("a",{href:"#",class:w(["btn btn-custom border-0",{active:!i.value.length}]),onClick:e[4]||(e[4]=q(()=>{i.value=[],d.value=[],y(p).push({query:{selectedindustry:y(o).query.selectedindustry,MultipleTypeArray:i.value}})},["prevent"]))},"全部",2)]),(a(!0),n(f,null,b(R.value,t=>(a(),n("li",{class:"me-2",key:t},[s("a",{href:"#",class:w(["btn btn-custom border-0",{active:i.value.includes(t)}]),onClick:q(r=>ie(t),["prevent"])},x(t),11,Le)]))),128))])])])):_("",!0),i.value.length||d.value.length?(a(),n("div",Ne,[s("div",ze,[e[12]||(e[12]=s("h3",{class:"fs-6 text-black text-opacity-50"},"類別細項",-1)),s("ul",Fe,[s("li",Ge,[s("a",{href:"#",class:w(["btn btn-custom border-0",{active:!d.value.length}]),onClick:e[5]||(e[5]=q(()=>{d.value=[],y(p).push({query:{selectedindustry:y(o).query.selectedindustry,MultipleTypeArray:i.value.join(),selected:d.value}})},["prevent"]))},"全部",2)]),(a(!0),n(f,null,b(de.value,t=>(a(),n("li",{class:"me-2",key:t},[s("a",{href:"#",class:w(["btn btn-custom border-0",{active:d.value.includes(t)}]),onClick:q(r=>ce(t),["prevent"])},x(t),11,Ue)]))),128)),s("li",null,[$.value.length>8?(a(),n("a",{key:0,href:"#",class:"btn text-primary border-0",onClick:e[6]||(e[6]=q(t=>j.value=!j.value,["prevent"]))},x(j.value?"收起－":"更多+"),1)):_("",!0)])])])])):_("",!0)]),m.value!=="全部"?(a(),n("h3",Ze,"廠商")):_("",!0),y(o).query.search?(a(),n("div",{key:1,ref_key:"scrollbox",ref:I},[s("p",He,[e[14]||(e[14]=O(" 以下為 ")),s("span",Ke,x(y(o).query.search),1),e[15]||(e[15]=O(" 的搜尋結果 ")),s("button",{type:"button",class:"btn btn-sm btn-danger me-2",onClick:q(H,["prevent"])},e[13]||(e[13]=[s("span",{class:"material-symbols-outlined d-inline-block align-middle"}," close ",-1)]))]),s("div",Qe,[e[16]||(e[16]=O(" 已選取：")),(a(!0),n(f,null,b(v.value,t=>(a(),n("span",{key:t,class:"badge rounded-pill text-bg-secondary fw-normal fs-6 bg-warning me-2 mb-1"},x(t),1))),128))]),s("div",We,[e[17]||(e[17]=O(" 全部：")),(a(!0),n(f,null,b(y(K),t=>(a(),n("span",{class:w(["btn bedge-custom rounded-pill me-1 mb-1",{active:v.value.includes(t)}]),key:t,onClick:q(r=>re(t),["prevent"])},x(t),11,Pe))),128))]),(u=k.value)!=null&&u.length?(a(),n("div",Ye,[(a(!0),n(f,null,b(k.value,t=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:t.編號},[C(L,{onGoCompany:D,company:t,"mutiple-type-array":A.value,tag:["編號","廠商","網址","類別","公司簡介","評測"]},null,8,["company","mutiple-type-array"])]))),128))])):(a(),n("div",Xe,e[18]||(e[18]=[s("img",{src:Y,alt:"無資料"},null,-1)])))],512)):m.value!=="全部"&&!y(o).query.search?(a(),n("div",Je,[G.value.length?(a(!0),n(f,{key:0},b(G.value,t=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:t.編號},[C(L,{onGoCompany:D,company:t,"mutiple-type-array":i.value,tag:["編號","廠商","網址","評測"]},null,8,["company","mutiple-type-array"])]))),128)):(a(),n("div",et,e[19]||(e[19]=[s("img",{src:Y,alt:"無資料"},null,-1)])))])):_("",!0),m.value==="全部"&&!y(o).query.search?(a(!0),n(f,{key:3},b(z.value,t=>(a(),n("div",{class:"mb-4",key:t.編號},[s("h3",tt,x(Object.keys(t).toString()),1),s("div",st,[(a(!0),n(f,null,b(t[Object.keys(t)],r=>(a(),n("div",{class:"col-xxs-6 col-lg-3",key:r.編號},[C(L,{onGoCompany:D,company:r,"mutiple-type-array":i.value,tag:["編號","廠商","網址","類別","公司簡介","評測"]},null,8,["company","mutiple-type-array"])]))),128))])]))),128)):_("",!0)])],64)}}};export{ut as default};
